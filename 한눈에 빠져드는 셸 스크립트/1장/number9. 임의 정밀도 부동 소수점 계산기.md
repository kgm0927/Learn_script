
스크립트 작성에서 가장 일반적으로 사용되는 시퀀스 중 하나는 `$(())`로, 다양한 기초 수학 함수를 사용해 계산을 할 수 있도록 해 준다. 이 시퀀스는 카운터 변수 증가와 같은 일반적인 연산을 용이하게 해 준다. 분수 또는 십진수값이 아닌 더하기, 빼기, 나눈기, 나머지(모듈로) 및 곱하기 연산을 지원한다. 그러므로 다음 명령은 0.5가 아니라 0을 반환한다.


```shell
echo $(( 1 / 2 ))
```

따라서 더 나은 정밀도가 필요한 값을 계산할 때는 난관에 부딫히게 된다. 커맨드 라인에서 동작하는 계산기 프로그램이 많지 않다. 단 하나의 예외는 [[bc]]다. bc는 소수의 유닉스 사람들만 배우는 별난 프로그램이다. bc 프로그램은 스스로를 임의의 정밀도 계산기로 명령하면서 암호 오류 메시지를 정확하게 zero 프롬프트로 완비된 유닉스 초창기 시절로 거슬러 올라간다. 그리고 사용하는 경우라면, 하려는 작업을 이미 알고 있다. 하지만 괜찮다. [리스트 1-20]에서 보듯이 bc보다 좀 더 사용자에게 친숙하게 만들기 위한 래퍼를 만들 수 있다.

---
### 코드

- [리스트 1-20]: scriptbc 스크립트

```shell
#!/bin/bash

  

# scriptbc -- 계산의 결과를 리턴하는 'bc' 래퍼 스크립트

  

if [ "$1" = "-p" ]; then # (#1)

precision=$2

shift 2

else

precision=2 # 기본값 (#2)

fi

  

bc -q -l << EOF # (#3)

scale=$precision

$*

quit

EOF

  

exit 0
```


---

### 동작 방식

`(#3)`의 `<<` 표기는 스크립트의 내용을 포함하게 해 주고, 이를 입력 스트림에 직접 입력한 것처럼 처리할 수 있다. 이 경우 bc 프로그램에 명령을 전달하는 쉬운 메커니즘을 제공한다. 이를 *here document* 작성이라고 한다. 이 표기법에서 `<<` 시퀀스 뒤에 오는 것은 무엇이든 입력 스트림의 끝을 나타내기 위해 그 다음에 일치시키려고 하는(그 자체를 한 줄로) 것이다. [리스트 1-20]에서는 EOF이다.

또한 이 스크립트는 명령어를 보다 유연하게 사용하기 위해 인자를 어떻게 사용하는지를 보여준다. 여기서 스크립트가 `-p`플래그 `(#1)`로 호출되면, 출력 숫자를 원하는 정밀도로 지정할 수 있다. 정밀도가 지정되지 않으면 프로그램의 기본값인 scale=2 `(#2)` 된다.

==bc와 함께 작업할 때는 length와 scale의 차이를 이해하는 것이 중요하다.== bc에 관한 한 length는 숫자의 총 자릿수를 의미하고, scale은 소수점 이하의 전체 자릿수다. 따라서 10.25는 길이가 4, scale은 2, 3.14159는 6, scale은 5이다.

기본적으로 bc는 length에 대해 가변값을 갖지만, 0의 스케일을 갖기 때문에 수정 사항이 없는 bc는 `$(())` 표기법과 정확히 동일하게 동작한다. 다행스럽게도 bc에 scale 설정을 추가하면 1962년에서 2002년 사이(윤년 제외)에 몇 주가 지났는지 계산하는 이 예제에서 볼 수 있듯이 숨겨진 이점이 많음을 알 수 있다.

```shell
 kali@kali  ~  bc
bc 1.07.1
Copyright 1991-1994, 1997, 1998, 2000, 2004, 2006, 2008, 2012-2017 Free Software Foundation, Inc.
This is free software with ABSOLUTELY NO WARRANTY.
For details type `warranty'. 
scale=10
(2002-1962)*365
14600
14600/7
2085.7142857142
quit

```

커맨드라인에서 bc 기능에 접근할 수 있게 하려면, 래퍼(wrapper) 스크립트가 공개 저작권 정보를 묵인해야 한다. 존재하는 경우 - 입력이 터미널 (stdin)이 아니라면, 대부분의 bc 구현이 이미 헤더를 묵인한다. 래퍼는 스케일을 적당한 값으로 설정하고 실제 표현식을 bc 프로그램에 전달한 후, quit 명령으로 종료한다.


---

### 스크립트 실행하기

이 스크립트를 실행하려면, [리스트 1-21]과 같이 프로그램에 수식을 입력해야 한다.

### 결과


- [리스트 1-21]: scriptbc 스크립트 테스트
```shell
 kali@kali  ~  scriptbc 14600/7 
2085.71
 kali@kali  ~  scriptbc -p 10 14600/7
2085.7142857142

```