
---
# 히스토리 사용


bash는 입력된 명령어에 대한 히스토리를 가지고 있다. 이러한 히스토리는 홈 디렉토리에 .hash_history라는 파일로 저장된다. 키보드 입력하는 시간을 줄여주는 유용한 자원이다.


- 히스토리 검색


언제든지 히스토리 목록을 확인할 수 있다.

``` shell
kgm0917@DESKTOP-DT2VQLB:~$ history | less
```


기본값으로 bash는 사용자가 입력한 최근 500개의 명령어를 저장할 수 있다. 그리고 이제 /usr/bin 디렉토리에서 사용하던 명령어를 찾아보려고 할 때, 한가지 방법이 있다.

``` shell
kgm0917@DESKTOP-DT2VQLB:~$ history | grep /usr/bin
```

다음과 같이 출력 결과 중 필요한 명령어가 포함된 줄을 찾았을 때


``` shell
88 ls –l /usr/bin > ls-output.txt
```


숫자 88은 히스토리 목록에서 그 명령어가 있는 줄 번호다. 이것을 **히스토리 확장**이라고 하는데 다른 형식의 확장으로 활용할 수 있다.



bash는 또한 히스토리 목록 증가분에 따라 검색 기능을 제공한다. 이는 글자를 입력하면서 히스토리 목록을 검색하도록 bash에 명령을 주면 각 글자가 추가될 때마다 우리가 원하는 검색 결과를 골라서 보여준다는 것이다. 이러한 증분 검색을 시작하기 위해서 하는 텍스트에 ctrl-R 키를 입력하라.

원하는 결과를 얻었다면 엔터키를 눌러서 명령어를 실행하거나 ctrl-j 키를 입력하여 히스토리 결과를 복사하여 현재 커맨드라인에 붙이면 된다.

``` shell
kgm0917@DESKTOP-DT2VQLB:~$
```

ctrl-R키를 입력한다.

``` shell
(reverse-i-search)`':
```

프롬프트는 역순 검색을 수행하도록 한다. 즉 “현재”부터 지난 한 시점까지 검색하는 것이기 때문에 “역순”인 것이다. 그 다음, 검색하려는 텍스트를 입력한다. 여기 이 예제에서는 /usr/bin 디렉토리를 검색하게 된다.

``` shell
(reverse-i-search)`ls': 71 ls –l /usr/bin
```

곧바로 검색 결과가 표시된다. 이제 엔터키를 눌러서 명령어를 바로 실행할 수 있다. 또는 ctrl-J 키를 입력해서 추후 편집을 위해 현재 커맨드라인에 그 명령어를 복사할 수 있다.

``` shell
kgm0917@DESKTOP-DT2VQLB:~$ 71 ls –l /usr/bin
```

쉘 프롬프트는 결과를 보여주고 커맨드라인은 실행을 위한 준비가 완료된다.


[표 8-5] 히스토리 명령어

| 키      | 실행                                                                          |
| ------ | --------------------------------------------------------------------------- |
| ctrl-P | 이전 히스토리 항목으로 이동, 위쪽 화살표키와 동일함                                               |
| ctrl-N | 다음 히스토리 항목으로 이동, 아래쪽 화살표키와 동일함                                              |
| alt-<  | 히스토리 목록 처음으로 이동.                                                            |
| alt->  | 히스토리 목록 마지막으로 이동(현재 커맨드라인 기준).                                              |
| ctrl-R | 역순 증분 검색. 현재 커맨드라인에서 히스토리 목록으로 증분 검색                                        |
| alt-N  | 순방향 검색(forward) 검색, 증분 검색 아님.                                               |
| ctrl-O | 히스토리 목록에 있는 현재 항목을 실행하고 다음 항목으로 이동한다. 히스토리 목록에 있는 순서대로 명령어를 재실행할 때 매우 편리하다. |



- 히스토리 확장

쉘은 ! 기호를 사용해서 히스토리 목록에 있는 항목들에 특수한 형식의 확장을 지원한다. 히스토리 목록에서 하나의 항목을 가져오기 위해 번호 앞에 표시한다. 그 외 다양하게 있다.

히스토리 확장에는 굉장히 많은 항목들이 활용할 수 있지만 이 장은 너무나 이해하기 힘들다. bash man 페이지에 있는 “히스토리 확장” 섹션에 자세하게 나와있는 내용을 부담 갖지 말고 천천히 살펴보도록 한다.


[표 8-6]


| 시퀀스      | 실행                                                    |
| -------- | ----------------------------------------------------- |
| !!       | 마지막 명령어를 반복하여 실행. 위쪽 화살표와 엔터키를 입력하는 것보다 아마 더 용이할 것이다. |
| !number  | 이 번호에 해당하는 항목을 실행                                     |
| !string  | 이 문자열로 시작하는 가장 최근에 입력된 항목을 실행                         |
| !?string | dl 문자열이 포함된 가장 최근에 입력된 항목을 실행                         |


- ***==부연 설명==***

스크립트

대부분의 리눅스 배포판에는 bash 명령어 히스토리의 기능뿐만 아니라, 스크립트라고 하는 프로그램을 가지고 있다. 이것음 모든 쉘 세션을 기록하고 파일에 저장하기 위해 사용될 수 있다. 기본적인 형식 명령은 다음과 같다.

```
script [file]
```

file에는 세션 기록을 저장할 파일명을 입력하다. 파일명이 지정되지 않음녀 typescript라는 파일이 사용된다. 이 프로그램의 옵션과 기능에 대한 완벽한 정보가 들어있는 script man 패이지를 확인해 보길 바란다.