


---
# 소유자, 그룹 멤버, 기타 사용자

``` shell
kgm0917@DESKTOP-DT2VQLB:~$ file /etc/shadow

/etc/shadow: regular file, no read permission

kgm0917@DESKTOP-DT2VQLB:~$ less /etc/shadow

/etc/shadow: Permission denied
```

/etc/shadow 와 같은 파일을 확인하려고 하는 경우에 문제가 발생할 수 있다.

이 오류의 원인은 이 파일을 읽을 권한이 없는 일반 사용자이기 때문이다.

유닉스 보안 모델에서 사용자는 파일과 디렉토리를 **소유**할 수 있다. 사용자가 파일 또는 디렉토리를 소유할 때, 그 사용자는 소유물의 접근을 제어한다. 또한 사용자들은 한 명 이상으로 구성된 **그룹**에 속할 수 있다. 같은 그룹 사용자들은 그 소유자에 의해 파일과 디렉토리에 접근 권한을 얻는다.

그룹에 접근을 허용하는 것 외에도, 소유자는 모든 사용자(유닉스 용어로는 world)에게 접근 권한 일부를 줄 수 있다. 자신의 사용자 ID 정보를 확인하기 위해 id 명령어를 사용한다.

``` shell
kgm0917@DESKTOP-DT2VQLB:~$ id

uid=1000(kgm0917) gid=1000(kgm0917) groups=1000(kgm0917),4(adm),20(dialout),24(cdrom),25(floppy),27(sudo),29(audio),30(dip),44(video),46(plugdev),116(netdev)
```


사용자 계정이 생성되면, 사용자들은 **사용자 ID**(user ID)또는 uid라 불리는 번호를 할당 받는다. 그리고 나서 사용자를 위해서 사용자 이름을 할당한다. 그 사용자는 **주 그룹 ID**(gid)를 할당 받고 추가로 다른 그룹에도 속할 수 있다.


여기서는 페도라와 우분투를 비교하자면 uid와 gid의 번호를 보면, 페도라는 계정에 500번부터 할당하고, 우분투는 1000부터 할당한다. 또한 우분투 사용자는 더 많은 그룹에 속해 있다는 것을 볼 수 있다. 이것은 시스템 디바이스와 서비스에 대한 특권을 우분투가 관리하는 방식과 관련이 있다.

그럼 이런 정보들은 어디서 오는가? 리눅스에 존재하는 다른 것처럼, 다수의 텍스트 파일에서 얻어온다. 사용자 계정은 /etc/passwd 파일에 정의되어 있고, 그룹은 /etc/group 파일에 정의되어 있다. 사용제 계정과 그룹이 생성이 되면, 이 파일들은 사용자 비밀번호에 관한 정보를 가진 /etc/shadow에 덧붙여 수정된다.

각각의 사용자 계정은 /etc/passwd 파일에 그 사용자 이름, uid,gid, 실제 사용자 이름, 홈 디렉토리와 로그인 쉘 정보가 저장된다. /etc/passwd 와 /etc/group 파일의 내용을 확인하게 되면, 일반 사용자 계정 뿐만 아니라 슈퍼유저(uid 0)와 다른 시스템 사용자 계정도 존재한다는 것을 알 수 있다.

유닉스형 시스템은 일반 사용자를 **users**와 같이 일반 그룹에 할당하는 반면, 현재 리눅스 계열은 사용자의 이름과 동일한 유일한 그룹에 하나의 멤버만을 할당한다. 이는 권한(premission)할당 타입을 확인하기가 쉽다.

---
# 읽기, 쓰기, 실행


파일과 디렉토리의 접근권은 읽기 권한, 쓰기 권한, 실행 권한이란 용어로 정의된다. ls 명령어의 출력 결과를 보면 이들이 어떻게 구현되었는지 단서를 얻을 수 있다.


``` shell
kgm0917@DESKTOP-DT2VQLB:~$ > foo.txt

kgm0917@DESKTOP-DT2VQLB:~$ ls -l foo.txt

-rw-r--r-- 1 kgm0917 kgm0917 0 Jan 29 15:10 foo.txt
```

세 번째의 문자을 주의깊게 보라. 처음 10개의 문자는 **파일 속성**을 나타낸 것이다. 첫 문자는 **파일의 종류**(file type)를 나타낸다.


ex)

`-rwxrw-r--`

첫 번째 자리: 파일의 종류

2~4 번째 자리: Owner 퍼미션

5~7 번째 자리: Group 퍼미션

8~10 번째 자리: World 퍼미션   


파일 속성의 나머지 9개의 문자는 파일 모드(file mode)라고 불린다. 그것은 파일 소유자, 파일 소유 그룹, 기타 사용자에 대한 읽기, 쓰기, 실행 권한을 의미한다.


파일과 디렉토리에 r,w,x 모드 속성을 설정하면 밑의 두 번째 표와 설명한 것과 같은 효과가 있다.

[표 9-1] 파일 종류

| 속성  | 파일 종류                                                                              |
| --- | ---------------------------------------------------------------------------------- |
| -   | 일반 파일                                                                              |
| d   | 디렉토리                                                                               |
| l   | 심볼릭 링크, 심볼릭 링크의 파일 속성은 항상 rwxrwxrwx이고 그것은 더미 값이다. 실제 파일 속성은 심볼릭 링크가 가리키는 파일의 속성이다. |
| c   | 문자 특수 파일. 이 파일의 종류는 터미널이나 모뎀같이 바이트의 열로 데이터를 처리하는 디바이스를 나타낸다.                       |
| b   | 블록 특수 파일, 이 파일의 종류는 하드 드라이브나 CD-ROM 드라이브같이 블록 단위의 데이터를 처리하는 디바이스를 나타낸다.            |


[표 9-2] 퍼미션 속성

| 속성  | 파일                                                                                      | 디렉토리                                                    |
| --- | --------------------------------------------------------------------------------------- | ------------------------------------------------------- |
| r   | 파일 열기와 읽기를 허용한다.                                                                        | 실행 속성이 설정되어 있으면 디렉토리의 내용물을 나열할 수 있게끔 허용한다.              |
| w   | 이 속성은 파일 쓰기 또는 잘라내기는 허용하지만, 이름 변경이나 파일 삭제는 허용하지 않는다. 파일 삭제나 파일 이름 변경은 디렉토리 속성에 의해 결정된다. | 실행 속성이 설정되어 있으면 디렉토리 내의 파일들을 생성, 삭제, 이름 변경이 가능하도록 허용한다. |
| x   | 파일이 프로그램으로 처리되고 파일이 실행되도록 허용한다. 스크립트 언어에서 작성된 프로그램 파일들은 읽기 가능으로 설정되어야만 실행이 가능하다.        | 디렉토리에 들어올 수 있도록 허용한다.(예를 들어 cd directory 와 같이)          |


[표 9-3] 퍼미션 속성의 예제

|   |   |
|---|---|
|파일 속성|의미|
|-rwx------|파일 소유자에 의해 읽기, 쓰기, 실행이 가능한 일반 파일이다. 다른 사용자는 아무도 접근할 수 없다.|
|-rw-------|파일 소유자에 의해 읽기, 쓰기 가능한 일반 파일이다. 다른 사용자는 아무도 접근할 수 없다.|
|-rw-r--r--|파일 소유자에 의해 읽기, 쓰기 가능한 일반 파일이다. 파일 소유 그룹의 멤버는 읽을 수 있고, 기타 사용자도 읽기 가능하다.|
|-rwxr-xr-x|파일 소유자에 의해 읽기, 쓰기, 실행 가능한 일반 파일이다. 그룹 멤버와, 기타 사용자도 읽고 실행 가능하다.|
|-rw-rw----|파일 소유자와 소유 그룹 멤버만이 읽고 쓰기 가능한 일반 파일이다.|
|lrwxrwxrwx|심볼릭 링크, 모든 심볼릭 링크는 가짜(Dummy) 퍼미션을 가지고 있다. 실제 퍼미션은 심불릭 링크가 가리키는 실제 파일을 가지고 있다.|
|drwxrwx---|디렉토리, 소유자와 소유 그룹 멤버는 디렉토리 안으로 들어갈 수 있고, 디렉토리 내의 파일들을 생성, 삭제 및 이름 변경이 가능하다.|
|drwxr-x---|디렉토리. 소유자는 디렉토리 안으로 들어갈 수 있고, 디렉토리 안의 파일들을 생성, 삭제 및 이름 변경이 가능하다. 소유 그룹 멤버는 디렉토리 안으로 들어갈 수 있지만 파일들을 생성, 삭제 및 이름변경이 불가능하다.|