

diff도 comm 프로그램처럼, 파일 간의 차이점을 찾을 때 사용된다. 그러나 diff는 좀 더 많이 복잡한 툴이며, 많은 출력 포맷을 지원하고 한꺼번에 많은 텍스트 파일들을 처리할 수 있는 능력이 있다. diff는 소프트웨어 개발자들이 프로그램 소스 코드의 버전 간의 차이점을 확인하기 위해 종종 사용되는데, 그 이유는 소스 트리라 불리는 소스 코드의 디렉토리를 재귀적으로 확인할 수 있는 능력을 가지고 있기 때문이다. diff의 일반적인 사용 중 하나는 **diff 파일**을 만들거나 **패치**를 생성한다. 패치는 파일(또는 파일들)의 한 버전에서 다른 버전으로 변환하기 위해 [[patch]](곧 논의될)와 같은 프로그램에서 사용된다.


이전 예제 파일들을 살펴보기 위해 diff를 사용하면, 기본적인 출력 형태를 보게 된다. 두 파일의 차이점을 간결하게 설명한다.

``` shell
┌──(kali㉿kali)-[~]
└─$ diff file1.txt file2.txt
1d0
< a
4a4
> e

```

기본적인 출력 포맷은 각 변경 내역이 **범위 명령 범위** 형태의 변경 명령([표 20-4] 참조)을 가지게 된다. 첫 번째 파일에서 두 번째 파일로 변환된 위치와 형태에 대해 설명한다.

- [표 20-4] diff 변경 명령


| 변경 명령   | 설명                                                |
| ------- | ------------------------------------------------- |
| *r1ar2* | ==두 번째 파일==의 r2 위치에 있는 행을 ==첫 번째 파일==의 r1 위치에 추가. |
| *r1cr2* | r1 위치에 있는 행을 두 번째 파일의 r2 위치의 행으로 변경.              |
| *r1dr2* | 두 번째 파일의 r2 범위에 있어야 할 행을 첫 번째 파일의 r1 위치에서 삭제.     |
|         |                                                   |


이 포맷에서 범위는 시작 행과 마지막 행을 콤마로 구분한 것이다. 이 포맷이 기본이긴 하지만 (주로 POSIX 표준과 전통적인 유닉스 버전의 하위 호환성을 가진 [[diff]]), 다른 것처럼 널리 사용되진 않는다. 이보다 더 인기 있는 포맷 두 가지는 **문맥 방식**(context format)과 **통합 방식**(unified format)이다.


문맥 방식(-c 옵션)을 사용하면 결과는 다음과 같다.

``` shell
┌──(kali㉿kali)-[~]
└─$ diff -c file1.txt file2.txt
*** file1.txt   2024-10-03 02:19:23.943900790 -0400
--- file2.txt   2024-10-03 02:18:14.690548279 -0400
***************
*** 1,4 ****
- a
  b
  c
  d
--- 1,4 ----
  b
  c
  d
+ e

```


출력 결과는 두 파일의 이름과 타임스탬프로 시작한다. ==첫 번째 파일은 별표들로 표시==되고 ==두 번째 파일은 대시 기호들로 표시==된다. 목록의 나머지 부분에 전반적으로 이 표시들이 각각의 파일에 나타나게 될 것이다. 그 다음에 변경 내역을 해당 영역의 주변 행을 기본값에 따라 함께 보여준다. 첫 번째 내역에서 `*** 1,4 ****`는 첫 번째 파일의 1번부터 4번 행까지를 가리킨다. 그 뒤 `--- 1,4 ----`는 두 번째 파일의 1번부터 4번 행까지를 가리킨다. 변경 내역에서 각 행은 [표 20-5]에 보이는 것처럼 네 가지 중 하나의 지시자로 시작한다.


- [표 20-5] diff 문맥 변경 지시자

| 지시자  | 의미                                                    |
| ---- | ----------------------------------------------------- |
| (없음) | 문맥 표시 행, 두 파일 간의 차이점을 나타내지 않는다.                       |
| -    | 삭제된 행. 이 행은 첫 번째 파일에는 나타나지만 두 번째 파일에는 나타나지 않을 것이다.    |
| +    | 추가된 행. 이 행은 두 번째 파일에는 나타나지만 첫 번째 파일에는 나타나지 않을 것이다.    |
| !    | 변경된 행. 이 행은 두 가지 버전이 표시될 것이다. 변경 내역의 각자의 영역에 각각 표시된다. |

통합 방식은 문맥 방식과 유사하지만 더 간결하다. ==**-u** 옵션을 사용하면 다음과 같은 결과를 얻을 수 있다.==
``` shell

┌──(kali㉿kali)-[~]
└─$ diff -u file1.txt file2.txt        
--- file1.txt   2024-10-03 02:19:23.943900790 -0400
+++ file2.txt   2024-10-03 02:18:14.690548279 -0400
@@ -1,4 +1,4 @@
-a
 b
 c
 d
+e

```

문맥 방식과 통합 방식 간의 가장 두드러진 차이점은==문맥의 중복 행 제거==가 있다. 통합 방식의 결과는 문맥 방식보다 더 짧게 만들어진다. 이 예제를 보면 문맥 방식과 같은 **==파일 타임스탬프==** 가 있다. 이어서 `@@ -1,4 +1,4 @@` 문자열을 보게 된다. 이것은 변경 내역에 기술된 첫 번째 파일의 행들과 두 번째 파일의 행들을 나타낸다. 기본적으로 해당 행과 3줄이 더 따라오게 된다. [표 20-6]에 보이는 것처럼, 각 행은 세 가지 가용한 문자로 시작한다.


- [표 20-6] diff 통합 방식 변경 지시자


| 문자   | 의미                    |
| ---- | --------------------- |
| (없음) | 이 행은 두 파일 모두 공유한다.    |
| -    | 이 행은 첫 번째 파일에서 삭제되었다. |
| +    | 이 행은 첫 번째 파일에서 추가되었다. |
