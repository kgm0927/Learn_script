
groff는 troff GNU 구현물을 포함한 프로그램들의 모음이다. 또한 nroff를 흉내 내는 스크립트와 roff 계열의 나머지도 가지고 있다.

roff와 그 파생 프로그램들이 포맷된 문서를 만들기는 하지만 현 사용자들의 문서 작성 방식과는 꽤 이질적이다. 오늘날 대다수 문서는 작성과 레이아웃 구성을 한 번에 수행할 수 있는 워드 프로세스를 이용해서 만들어진다. 그래픽 환경의 워드 프로세서가 출현하기 이전에 문서들은 종종 두 단계를 거쳐 만들어졌다. 텍스트 편집기를 이용하여 문서를 작성한 것과, troff와 같은 프로그램으로 포맷을 지정하는 것이다. **문서 포맷 프로그램의 명령은 마크업 언어를 통해 구성된 텍스트에 포함되어 있다.** 현재 그와 유사한 절차를 가진 것은 웹 페이지다. 웹 페이지는 일종의 텍스트 편집기를 사용하여 작성하고 나서 페이지 레이아웃을 기술한 마크업 언어인 HTML을 사용하여 웹 브라우저에 의해 최종 구현된다.

우리는 타이포그래피의 신비로움을 주는 마크업 언어의 많은 요소들처럼 groff의 모든 것을 다루지는 않을 것이다. 대신에 광범위하게 사용되고 있는 **매크로 패키지**들 중 하나에 집중할 것이다. 이 매크로 패키지들은 groff를 좀 더 쉽게 사용할 수 있게 하는 저수준 명령의 다수를 더 작은 고수준 명령어 집합으로 압축한다.

잠시만, [[man]] 페이지를 살펴보자. 그것은 /usr/share/man 디렉토리에 gzip로 압축된 텍스트 파일로 존재한다. 만약 압축을 풀고 내용물을 살펴보면, 다음과 같이 보게 될 것이다(섹션1의 ls 명령 man 페이지를 보여준다).

```shell
┌──(kali㉿kali)-[~]
└─$ zcat /usr/share/man/man1/ls.1.gz | head  
.\" DO NOT MODIFY THIS FILE!  It was generated by help2man 1.48.5.
.TH LS "1" "March 2024" "GNU coreutils 9.4" "User Commands"
.SH NAME
ls \- list directory contents
.SH SYNOPSIS
.B ls
[\fI\,OPTION\/\fR]... [\fI\,FILE\/\fR]...
.SH DESCRIPTION
.\" Add any additional description here
.PP

```

우리는 일반적인 출력형태의 man 페이지와 비교해서, 마크업 언어와 그 결과 사이의 연관성을 다음처럼 보이게 시작할 수 있다.

```shell
                                                                                                                   
┌──(kali㉿kali)-[~]
└─$ man ls | head
LS(1)                                              User Commands                                             LS(1)

NAME
       ls - list directory contents

SYNOPSIS
       ls [OPTION]... [FILE]...

DESCRIPTION
       List  information  about the FILEs (the current directory by default).  Sort entries alphabetically if none
                                                         
```

이것은 groff가 mandoc 매크로 패키지를 사용하여 변환한 man 페이지기 때문에 흥미롭다. 사실 우리는 이 man 명령어 파이프라인을 시뮬레이션할 수 있다.

``` shell
┌──(kali㉿kali)-[~]
└─$ zcat /usr/share/man/man1/ls.1.gz | groff -mandoc -T ascii | head
LS(1)                            User Commands                           LS(1)

NAME
       ls - list directory contents

SYNOPSIS
       ls [OPTION]... [FILE]...

DESCRIPTION
       List  information  about  the FILEs (the current directory by default).

```

이처럼 groff 프로그램과 mandoc 매크로 패키지와 ASCII용 출력 드라이버를 명시한 옵션을 함께 사용할 수 있다. groff는 여러 포맷으로 출력 효과를 만들 수 있다. 만약 아무런 포맷이 지정되지 않으면, 다음처럼 기본적으로 포스트스크립트 형식으로 출력된다.

``` shell
┌──(kali㉿kali)-[~]
└─$ zcat /usr/share/man/man1/ls.1.gz | groff -mandoc | head         
%!PS-Adobe-3.0
%%Creator: groff version 1.23.0
%%CreationDate: Fri Oct  4 13:08:34 2024
%%DocumentNeededResources: font Times-Italic
%%+ font Times-Roman
%%+ font Times-Bold
%%DocumentSuppliedResources: procset grops 1.23 0
%%Pages: 4
%%PageOrder: Ascend
%%DocumentMedia: Default 595 842 0 () ()
                                                
```

포스트스크립트는 사진 식자기와 유사한 장치에 인쇄 페이지 내용물을 기술하기 위해 사용되는 페이지 기술 언어다. 우리는 명령어의 출력을 가져와서 파일로 저장할 수 있다(Desktop 디렉토리와 그래픽 데스크톱을 사용하고 있다고 가정).

``` shell
┌──(kali㉿kali)-[~]
└─$ zcat /usr/share/man/man1/ls.1.gz | groff -mandoc > ~/Desktop/foo.ps

```

출력 파일의 아이콘이 데스크톱에 나타날 것이다. 그 아이콘을 더블 클릭하면 페이지 뷰어가 시작하고 그 변환된 형태의 파일이 나타날 것이다.

- [그림 21-1] GNOME 환경에서 페이지 뷰어로 포스트스크립트 출력 보기
![[스크린샷 2024-10-05 021346.png]]

우리가 본 것은 ls의 멋지게 조판된 man 페이지다! 다음 명령으로 포스트스크립트 파일을 PDF(Portable Document Format) 파일로 변환할 수 있다.


```shell
┌──(kali㉿kali)-[~]
└─$ ps2pdf ~/Desktop/foo.ps ~/Desktop/ls.pdf

```

ps2pdf 프로그램은 고스트스크립트 패키지의 일부로 인해 인쇄를 지원하는 대다수의 리눅스 시스템에 설치되어 있다.


>[!tip] 저자주
>리눅스 시스템은 많은 파일 포맷 변환용 커맨드라인 프로그램들을 종종 가지고 있다. 그것들은 종종 format2format 형식의 이름을 사용한다. 이를 확인하기 위해 `ls /usr/bin/*[[:alpha:]]2[[:alpha:]]*` 명령을 사용해봐라. 또한 formattoformat 형식의 이름을 가진 프로그램도 한번 찾아봐라.


groff의 마지막 실습을 위해, 오랜 친구인 distros.txt를 다시 방문할 것이다. 이번에는 tbl 프로그램을 사용할 것이다. 이것은 우리의 리눅스 배포한 목록을 조판하고 표로 구성하기 위해 사용된다. 이를 위해서는, groff에 전달할 텍스트 스트림에 마크업을 추가하기 위해 예전의 sed 스크립트를 사용할 것이다.

먼저, tbl에 필요한 필수 요구 사항을 추가하기 위해 sed 스크립트를 수정할 필요가 있다. 텍스트 편집기를 사용하여 다음과 같이 distros.sed를 변경할 것이다.

``` shell
#sed script to produce Linux distributions report


1 i\
.TS\
center box;\
cb s s\
cb cb cb\
l n c.\
Linux Distributions Report\
=\
Name    Version    Released\
_
s/\([0-9]\{2\}\)\/\([0-9]\{2\}\)\/\([0-9]\{4\}\)$/\3-\1-\2/
$ a\
.TE

```

**Name Version Released**의 각 단어들은 스페이스가 아닌 탭으로 구분되었다. 스크립트가 제대로 동작하려면 주의 있게 사용해야 한다. 우리는 그 결과가 파일을 distros-tble.sed로 저장할 것이다. tbl은 표의 시작과 끝을 나타내기 위해 `.TS`와 `.TE`를 사용한다. `.TS`가 이끄는 열들은 표의 전역 속성을 정의한다. 이 예제에서는 페이지에 중앙 수평으로 놓이고 박스로 둘러싸인다. 정의 영역의 남은 열들은 표의 각 행의 레이아웃을 묘사한다. 이제 우리가 다시 새 sed 스크립트와 함께 보고서 생성 파이프라인을 실행하게 되면 다음과 같은 결과를 얻을 것이다.

```shell
┌──(kali㉿kali)-[~]
└─$ sort -k 1,1 -k 2n distros.txt | sed -f distros-tbl.sed | groff -t -T ascii 2>/dev/null
         +-------------------------------------------+
         |        Linux Distributions Report         |
         +-------------------------------------------+
         |  Name    Version    Released              |
         +-------------------------------------------+
         | Fedora           5             2006-03-20 |
         | Fedora           6             2006-10-24 |
         | Fedora           7             2007-05-31 |
         | Fedora           8             2007-11-08 |
         | Fedora           9             2008-05-13 |
         | Fedora          10             2008-11-25 |
         | SUSE            10.1           2007-05-11 |
         | SUSE            10.2           2006-12-07 |
         | SUSE            10.3           2007-10-04 |
         | SUSE            11.0           2008-06-19 |
         | Ubuntu           6.06          2006-06-01 |
         | Ubuntu           6.10          2006-10-26 |
         | Ubuntu           7.04          2007-04-19 |
         | Ubuntu           7.10          2007-10-18 |
         | Ubuntu           8.04          2008-04-24 |
         | Ubuntu           8.10          2008-10-30 |
         +-------------------------------------------+



```

groff에 -t 옵션을 추가하여 tbl과 텍스트 스트림을 전처리하도록 지시한다. 마찬가지로 -T 옵션은 기본 출력 수단인 포스트스크립트가 아닌 ASCII를 출력으로 사용하겠다고 알린다.

출력 포맷은 터미널 화면이나 타자기 방식의 프린터 능력이 제한되어 있다면 우리가 기대할 수 있는 최상이다. 만약 포스트스크립트를 출력으로 지정하고 그래픽 환경에서 출력 결과를 보면 더욱 더 만족스러운 결과를 얻을 것이다(그림 21-2 참조).

```shell
┌──(kali㉿kali)-[~]
└─$ sort -k 1,1 -k 2n distros.txt | sed -f distros-tbl.sed | groff -t > ~/Desktop/foo.ps  
                                                                                             
```

- [그림 21-2] 완성된 표 보기
![[스크린샷 2024-10-05 031207 1.png]]

---
# 마무리 노트

유닉스형 운영체제의 특성상 텍스트의 중요성을 고려하면, 텍스트를 조작하고 포맷을 지정하는 많은 툴들이 존재하는 것은 당연하다. 우리가 보았듯이, 많이 있다. [[fmt]]와 [[pr]]처럼 간단한 툴들은 짧은 문서를 생성하는 스크립트에서 많이 사용하는 것을 발견할 수 있다. 반면 groff(와 친구들)는 책을 만드는 데 사용할 수 있다. 우리가 커맨드라인을 사용하여 전문지를 작성하지 않을지도 모른다(많은 사람들이 그렇긴 하지만). 그러나 우리가 할 수 있는 것을 알아두는 것이 좋다.